<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendrier Anime Final</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #191919;
    font-family: Arial, sans-serif;
    color: #fff;
    height: 100%;
    overflow: hidden; /* plus de scroll */
  }

  .calendar-container {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    padding: 10px;
    box-sizing: border-box;
  }

  /* Mois et flèches */
  .month-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
  }

  .month-title {
    font-size: 22px;
    font-weight: bold;
  }

  .arrow {
    cursor: pointer;
    font-size: 56px; /* 2x plus grandes */
    user-select: none;
  }
  .arrow.disabled {
    opacity: 0.3;
    cursor: default;
  }

  .calendar-weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 3px;
    margin-bottom: 3px;
  }

  .weekday {
    text-align: center;
    font-weight: bold;
    color: #ccc;
    font-size: 12px;
  }

  .calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 3px;
    position: relative;
  }

  .day {
    background: #2b2b2b;
    padding: 5px;
    min-height: 70px;
    border-radius: 6px;
    position: relative;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    font-size: 12px;
  }
  .day:hover {
    transform: scale(1.03);
    box-shadow: 0 2px 10px rgba(255,255,255,0.2);
  }

  .day-number {
    font-weight: bold;
    margin-bottom: 3px;
  }

  .anime-rep {
    width: 100%;
    height: 8px;
    border-radius: 3px;
    margin-bottom: 2px;
  }

  /* Popup */
  .anime-popup {
    display: none;
    position: absolute;
    background: #2b2b2b;
    border: 1px solid #444;
    padding: 8px;
    z-index: 9999;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(255,255,255,0.3);
    width: 220px;
    font-size: 12px;
  }

  .anime-popup .close-btn {
    float: right;
    cursor: pointer;
    font-weight: bold;
    color: #888;
  }

  .anime-item {
    margin-bottom: 5px;
    padding: 3px;
    border-left: 4px solid #000;
  }
</style>
</head>
<body>

<div class="calendar-container">
  <div class="month-header">
    <div class="arrow" id="prev-month">&#8592;</div>
    <div class="month-title" id="month-title"></div>
    <div class="arrow" id="next-month">&#8594;</div>
  </div>

  <div class="calendar-weekdays">
    <div class="weekday">Lun</div>
    <div class="weekday">Mar</div>
    <div class="weekday">Mer</div>
    <div class="weekday">Jeu</div>
    <div class="weekday">Ven</div>
    <div class="weekday">Sam</div>
    <div class="weekday">Dim</div>
  </div>

  <div class="calendar" id="calendar"></div>
</div>

<div class="anime-popup" id="anime-popup">
  <div class="close-btn" id="popup-close">x</div>
  <div id="popup-content"></div>
</div>

<script>
  const calendarEl = document.getElementById("calendar");
  const monthTitleEl = document.getElementById("month-title");
  const popup = document.getElementById("anime-popup");
  const popupContent = document.getElementById("popup-content");
  const popupClose = document.getElementById("popup-close");
  const prevArrow = document.getElementById("prev-month");
  const nextArrow = document.getElementById("next-month");

  const currentYear = new Date().getFullYear();
  const startMonth = new Date(currentYear,0,1);
  const endMonth = new Date(currentYear+1,0,1);
  let currentDate = new Date(startMonth);

  // ---- Données simulées, peuvent être remplacées par API ----
  let animeData = [];

  function fetchAnimeData() {
    // Exemple pour brancher AniList API plus tard
    // Retourne un tableau d'animes avec : {title, date, ep, time, color}
    // Pour le prototype, on utilise des données fictives
    animeData = [];
    let frierenDate = new Date("2026-01-16");
    for (let i = 0; i < 5; i++) {
      animeData.push({ title: "Frieren S2", date: frierenDate.toISOString().split('T')[0], time: "20:00", ep: i+1, color: "#2ecc71" });
      frierenDate.setDate(frierenDate.getDate() + 7);
    }
    animeData.push({ title: "Jujutsu Kaisen S2", date: "2026-01-16", time: "19:00", ep: 1, color: "#3498db" });
    animeData.push({ title: "One Piece", date: "2026-01-18", time: "10:00", ep: 1015, color: "#e74c3c" });
    animeData.push({ title: "Naruto Shippuden", date: "2026-01-25", time: "21:00", ep: 400, color: "#f1c40f" });
  }

  function renderCalendar(date) {
    calendarEl.innerHTML = "";
    const year = date.getFullYear();
    const month = date.getMonth();
    monthTitleEl.textContent = date.toLocaleString("fr-FR", { month: "long", year: "numeric" });

    prevArrow.classList.toggle("disabled", date <= startMonth);
    nextArrow.classList.toggle("disabled", date >= endMonth);

    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const firstDay = new Date(year, month, 1).getDay();
    const offset = firstDay === 0 ? 6 : firstDay - 1;

    for (let i = 0; i < offset + daysInMonth; i++) {
      const dayEl = document.createElement("div");
      dayEl.className = "day";

      if (i >= offset) {
        const dayNum = i - offset + 1;
        dayEl.innerHTML = `<div class="day-number">${dayNum}</div>`;
        const dateStr = `${year}-${String(month+1).padStart(2,"0")}-${String(dayNum).padStart(2,"0")}`;
        const animeToday = animeData.filter(a => a.date === dateStr);

        animeToday.forEach(a => {
          const rep = document.createElement("div");
          rep.className = "anime-rep";
          rep.style.backgroundColor = a.color;
          dayEl.appendChild(rep);
        });

        if (animeToday.length > 0) {
          dayEl.onclick = () => {
            popupContent.innerHTML = "";
            animeToday.forEach(a => {
              const item = document.createElement("div");
              item.className = "anime-item";
              item.style.borderLeftColor = a.color;
              item.innerHTML = `<strong>${a.title}</strong><br>Ep ${a.ep} - ${a.time}`;
              popupContent.appendChild(item);
            });
            const rect = dayEl.getBoundingClientRect();
            const bodyRect = document.body.getBoundingClientRect();
            popup.style.top = (rect.bottom - bodyRect.top + 5) + "px";
            popup.style.left = (rect.left - bodyRect.left) + "px";
            popup.style.display = "block";
          };
        }
      }

      calendarEl.appendChild(dayEl);
    }
  }

  prevArrow.onclick = () => {
    if (currentDate <= startMonth) return;
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar(currentDate);
  };
  nextArrow.onclick = () => {
    if (currentDate >= endMonth) return;
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar(currentDate);
  };

  popupClose.onclick = () => {
    popup.style.display = "none";
  };

  fetchAnimeData(); // Remplir les données (API ou fictives)
  renderCalendar(currentDate);
</script>

</body>
</html>
